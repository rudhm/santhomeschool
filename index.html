<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Santhome Higher Secondary School | Excelling with Legacy</title>
    
    <!-- Preload Critical Image for Performance -->
    <link rel="preload" as="image" href="https://raw.githubusercontent.com/rudhm/santhomeschool/main/Slider/IMG-20241028-WA0018.jpg">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Fonts: EB Garamond (Doon Style) & Lato -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Lato', sans-serif; color: #333; overflow-x: hidden; }
        h1, h2, h3, h4, h5, h6 { font-family: 'EB Garamond', serif; }
        
        /* --- VARIABLES --- */
        :root {
            --color-primary: #0f172a; /* Slate 900 */
            --color-accent: #ca8a04; /* Gold */
            --color-light: #f8fafc;
            /* Updated to use one of the valid slider images as CSS fallback */
            --hero-image: url('https://raw.githubusercontent.com/rudhm/santhomeschool/main/Slider/IMG-20241028-WA0018.jpg');
        }

        /* --- UI COMPONENTS --- */
        
        /* 1. Ticker / Marquee */
        .news-ticker-wrap {
            width: 100%;
            overflow: hidden;
            background-color: #fff;
            border-bottom: 1px solid #e5e7eb;
            height: 50px;
            display: flex;
            align-items: center;
        }
        .ticker-label {
            background: var(--color-primary);
            color: #fff;
            padding: 0 20px;
            height: 100%;
            display: flex;
            align-items: center;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.8rem;
            z-index: 10;
            white-space: nowrap;
        }
        .ticker-content {
            display: flex;
            animation: ticker 30s linear infinite;
            white-space: nowrap;
            padding-left: 100%;
        }
        .news-ticker-wrap:hover .ticker-content {
            animation-play-state: paused;
        }
        .ticker-item {
            padding: 0 2rem;
            color: #333;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
        }
        .ticker-item i { color: var(--color-accent); margin-right: 8px; }
        @keyframes ticker {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        /* 2. Hero Slider Fade */
        .hero-slide {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            transition: opacity 1.5s ease-in-out, transform 6s ease;
            transform: scale(1.05);
            z-index: 0;
        }
        .hero-slide.active { opacity: 1; transform: scale(1); z-index: 1; }
        .hero-overlay {
            position: absolute; inset: 0;
            /* Improved contrast for readability */
            background: linear-gradient(rgba(15, 23, 42, 0.45), rgba(15, 23, 42, 0.65));
            z-index: 2;
            pointer-events: none;
        }

        /* 3. Doon "Life At" Strip */
        .life-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
        }
        .life-item {
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            height: 380px; /* Reduced height for better balance */
            background-color: #0f172a;
        }
        .life-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
            opacity: 0.8;
        }
        .life-item:hover img, .life-item.mobile-active img { 
            transform: scale(1.1); 
            opacity: 0.4; 
        }
        .life-overlay {
            position: absolute;
            bottom: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to top, rgba(15, 23, 42, 1) 0%, rgba(15, 23, 42, 0.2) 50%, transparent 100%);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 2rem;
            transition: all 0.3s ease;
        }
        .life-item:hover .life-overlay, .life-item.mobile-active .life-overlay {
            background: rgba(15, 23, 42, 0.8);
            justify-content: center;
            align-items: center;
            text-align: center;
            padding-bottom: 2rem;
        }
        
        .life-title {
            font-size: 1.5rem;
            color: white;
            font-family: 'EB Garamond', serif;
            border-bottom: 2px solid #ca8a04;
            padding-bottom: 0.5rem;
            display: inline-block;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .life-text {
            height: 0;
            opacity: 0;
            overflow: hidden;
            transition: all 0.4s ease;
            transform: translateY(20px);
            color: #e2e8f0;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        .life-item:hover .life-text, .life-item.mobile-active .life-text {
            height: auto;
            opacity: 1;
            transform: translateY(0);
            margin-top: 1rem;
        }
        
        /* 4. Full Screen Menu */
        .menu-overlay {
            position: fixed;
            top: 0; right: 0; bottom: 0; left: 0;
            background: var(--color-primary);
            z-index: 100;
            transform: translateY(-100%);
            transition: transform 0.5s cubic-bezier(0.77, 0, 0.175, 1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .menu-overlay.open { transform: translateY(0); }
        .menu-link {
            color: #fff;
            font-family: 'EB Garamond', serif;
            font-size: 2.5rem;
            margin: 10px 0;
            transition: 0.3s;
            position: relative;
        }
        .menu-link:hover { color: var(--color-accent); transform: translateX(10px); }
        .menu-close {
            position: absolute;
            top: 30px; right: 30px;
            color: #fff;
            font-size: 2rem;
            cursor: pointer;
        }

        /* 5. Messages Section (Headmaster/Chairman) */
        .message-card {
            background: #fff;
            padding: 40px 30px;
            border-top: 4px solid var(--color-primary);
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .message-card:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }

        /* Animation Classes */
        .reveal-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .reveal-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Responsive Tweaks */
        @media (max-width: 1024px) {
            .life-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 640px) {
            .life-grid { grid-template-columns: 1fr; }
            .ticker-label { font-size: 0.7rem; padding: 0 10px; }
        }
        
        /* Utility */
        .btn-gold {
            background-color: var(--color-accent);
            color: white;
            padding: 12px 30px;
            text-transform: uppercase;
            font-size: 0.8rem;
            font-weight: 700;
            letter-spacing: 1.5px;
            display: inline-block;
            transition: 0.3s;
            border: 1px solid var(--color-accent);
        }
        .btn-gold:hover { background-color: transparent; border-color: #fff; color: #fff; }
        
        /* Modal */
        #topper-modal { transition: opacity 0.3s ease; }
        #topper-modal.hidden { opacity: 0; pointer-events: none; }
        #topper-modal:not(.hidden) { opacity: 1; pointer-events: auto; }
        
        /* Counter */
        .counter-num { font-variant-numeric: tabular-nums; }
        .break-all { word-break: break-all; }

        /* Typography Refinements */
        h2 {
            letter-spacing: 0.04em;
        }
        p {
            line-height: 1.75;
        }
        #hero-title {
            letter-spacing: 0.02em;
        }
    </style>

    <script>
        // --- Robust Image Loader ---
        function handleImageError(img, fallbackIdOrUrl) {
            if (img.dataset.failed === "true") return; // Stop infinite loops

            const currentSrc = img.src;
            const repoBase = 'https://raw.githubusercontent.com/rudhm/santhomeschool';
            let retries = parseInt(img.getAttribute('data-retries') || '0');
            img.setAttribute('data-retries', retries + 1);
            const filename = currentSrc.split('/').pop();

            if (retries === 0) img.src = `${repoBase}/main/uploads/${filename}`;
            else if (retries === 1) img.src = `${repoBase}/master/${filename}`;
            else if (retries === 2) img.src = `${repoBase}/master/uploads/${filename}`;
            else {
                if (fallbackIdOrUrl) {
                    if (fallbackIdOrUrl.startsWith('http')) img.src = fallbackIdOrUrl;
                    else {
                        img.style.display = 'none';
                        const fallbackEl = document.getElementById(fallbackIdOrUrl);
                        if (fallbackEl) fallbackEl.classList.remove('hidden');
                    }
                } else { 
                    img.dataset.failed = "true";
                    img.style.display = "none";
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50">

    <!-- FULL SCREEN MENU OVERLAY -->
    <div class="menu-overlay" id="menu-overlay">
        <button class="menu-close" onclick="toggleMenu()">&times;</button>
        <nav class="text-center">
            <a href="#home" class="menu-link block" onclick="toggleMenu()">Home</a>
            <a href="#about" class="menu-link block" onclick="toggleMenu()">About Us</a>
            <a href="#academics" class="menu-link block" onclick="toggleMenu()">Academics</a>
            <a href="#life" class="menu-link block" onclick="toggleMenu()">Life at Santhome</a>
            <a href="#news" class="menu-link block" onclick="toggleMenu()">News & Events</a>
            <a href="#contact" class="menu-link block" onclick="toggleMenu()">Contact</a>
            <div class="mt-8">
                <a href="#disclosure" class="text-yellow-500 font-bold uppercase tracking-widest text-sm border border-yellow-500 px-6 py-3 hover:bg-yellow-500 hover:text-white transition" onclick="toggleMenu()">Mandatory Disclosure</a>
            </div>
        </nav>
    </div>

    <!-- HEADER -->
    <header class="bg-white shadow-sm sticky top-0 z-40 transition-all duration-300" id="main-header">
        <!-- Top Bar -->
        <div class="hidden lg:flex justify-end bg-slate-900 text-slate-300 text-xs py-2 px-8 font-bold uppercase tracking-widest border-b border-slate-800">
            <div class="space-x-6">
                <a href="#" class="hover:text-yellow-500 transition">Alumni</a>
                <a href="#" class="hover:text-yellow-500 transition">Parent Portal</a>
                <a href="#" class="hover:text-yellow-500 transition">ERP Login</a>
                <a href="tel:07674232453" class="text-yellow-500"><i class="fas fa-phone-alt mr-2"></i>07674 – 232453</a>
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-24 flex justify-between items-center">
            <!-- Branding -->
            <a href="#" class="flex items-center gap-4">
                <img 
                    src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/STHS-Logo.png" 
                    alt="Santhome" 
                    class="h-16 w-auto"
                    onerror="handleImageError(this, 'fallback-logo')"
                >
                <div id="fallback-logo" class="hidden h-14 w-14 bg-slate-900 rounded-full flex items-center justify-center text-yellow-500 text-2xl"><i class="fas fa-graduation-cap"></i></div>
                <div class="hidden sm:block">
                    <h1 class="text-2xl font-bold text-slate-900 leading-none font-serif">Santhome</h1>
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest mt-1">Higher Secondary School</p>
                </div>
            </a>

            <!-- Right Controls -->
            <div class="flex items-center gap-6">
                <button class="text-slate-400 hover:text-slate-900 transition"><i class="fas fa-search text-xl"></i></button>
                <div class="flex items-center gap-3 cursor-pointer group" onclick="toggleMenu()">
                    <span class="text-sm font-bold uppercase tracking-widest text-slate-900 group-hover:text-yellow-600 transition hidden md:block">Menu</span>
                    <div class="w-10 h-10 bg-slate-900 text-white flex items-center justify-center rounded-sm group-hover:bg-yellow-600 transition">
                        <i class="fas fa-bars"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ANNOUNCEMENT TICKER -->
    <div class="news-ticker-wrap">
        <div class="ticker-label"><i class="fas fa-bullhorn mr-2"></i> Updates</div>
        <div class="ticker-content">
            <div class="ticker-item"><i class="fas fa-star"></i> Admissions Open for 2025-26 (Nursery - Class XI)</div>
            <div class="ticker-item"><i class="fas fa-trophy"></i> Congratulations to our Class XII Toppers!</div>
            <div class="ticker-item"><i class="fas fa-calendar-alt"></i> Annual Sports Meet scheduled for Dec 15th</div>
            <div class="ticker-item"><i class="fas fa-file-pdf"></i> Download Updated Book List 2025-26</div>
            <div class="ticker-item"><i class="fas fa-star"></i> Admissions Open for 2025-26 (Nursery - Class XI)</div>
            <div class="ticker-item"><i class="fas fa-trophy"></i> Congratulations to our Class XII Toppers!</div>
        </div>
    </div>

    <!-- LIVE HERO SLIDER -->
    <section id="home" class="relative h-[85vh] bg-slate-900 overflow-hidden group">
        <!-- Overlay -->
        <div class="hero-overlay"></div>
        
        <!-- Slides -->
        <div id="hero-slider-container">
            <!-- Slides injected by JS -->
        </div>

        <!-- Static Content Overlay -->
        <div class="absolute inset-0 flex items-center justify-center text-center px-4 z-20 pointer-events-none">
            <div class="max-w-4xl pointer-events-auto">
                <!-- Reduced mobile text size to text-4xl -->
                <h2 id="hero-title" class="text-4xl md:text-7xl text-white font-bold mb-6 drop-shadow-lg transition-all duration-700">40 Years of Excellence</h2>
                <p id="hero-subtitle" class="text-xl text-slate-200 font-light mb-10 transition-all duration-700 delay-200">Excelling with Legacy, Leading with Purpose</p>
                <div class="transition-all duration-1000 delay-500">
                    <a href="#about" class="btn-gold">Discover More</a>
                </div>
            </div>
        </div>
        
        <!-- Mouse Scroll Animation -->
        <a href="#why-choose" class="scroll-downs z-20">
            <div class="mousey">
                <div class="scroller"></div>
            </div>
        </a>
    </section>

    <!-- WHY CHOOSE SANTHOME -->
    <section id="why-choose" class="py-24 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid lg:grid-cols-2 gap-16 items-center">
                <!-- Image Left -->
                <div class="relative reveal-on-scroll">
                    <img 
                        src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/School-img.png" 
                        alt="Why Choose Us" 
                        class="w-full h-auto shadow-2xl rounded-sm"
                        onerror="handleImageError(this, '')"
                    >
                    <div class="absolute -bottom-6 -right-6 w-32 h-32 bg-yellow-50 -z-10 rounded-sm"></div>
                </div>
                
                <!-- Content Right -->
                <div class="reveal-on-scroll">
                    <h4 class="text-yellow-600 font-bold text-sm uppercase tracking-widest mb-3">Heritage & Values</h4>
                    <h2 class="text-4xl text-slate-900 font-bold mb-6">WHY CHOOSE SANTHOME?</h2>
                    <p class="text-slate-600 mb-8 text-lg leading-relaxed font-light">
                        As a premier Catholic educational institution since 1982, managed by the Satna Diocesan Society, we remain committed to cultivating intellect, character, and future leaders grounded in moral values.
                    </p>
                    
                    <!-- Stats Grid -->
                    <div class="grid grid-cols-2 gap-6" id="stats-container">
                        <div class="bg-slate-50 p-6 text-center border border-slate-100 hover:border-yellow-500 transition group">
                            <span class="block text-3xl font-bold text-slate-900 mb-1 counter-num" data-target="40">0</span>
                            <span class="text-xs uppercase text-slate-500 font-bold tracking-wider group-hover:text-yellow-600">Years Legacy</span>
                        </div>
                        <div class="bg-slate-50 p-6 text-center border border-slate-100 hover:border-yellow-500 transition group">
                            <span class="block text-3xl font-bold text-slate-900 mb-1 counter-num" data-target="100">0</span>
                            <span class="text-xs uppercase text-slate-500 font-bold tracking-wider group-hover:text-yellow-600">Pass Rate %</span>
                        </div>
                        <div class="bg-slate-50 p-6 text-center border border-slate-100 hover:border-yellow-500 transition group">
                            <span class="block text-3xl font-bold text-slate-900 mb-1">CBSE</span>
                            <span class="text-xs uppercase text-slate-500 font-bold tracking-wider group-hover:text-yellow-600">Affiliated</span>
                        </div>
                        <div class="bg-slate-50 p-6 text-center border border-slate-100 hover:border-yellow-500 transition group">
                            <span class="block text-3xl font-bold text-slate-900 mb-1">Co-Ed</span>
                            <span class="text-xs uppercase text-slate-500 font-bold tracking-wider group-hover:text-yellow-600">Campus</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ABOUT SECTION -->
    <section id="about" class="py-20 bg-slate-50">
        <div class="max-w-4xl mx-auto px-4 text-center mb-16 reveal-on-scroll">
            <h2 class="text-4xl text-slate-900 font-bold mb-4">About The School</h2>
            <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/Underline.png" class="mx-auto h-3 opacity-50 mb-6" alt="decoration">
            <p class="text-slate-600 leading-relaxed text-lg">
                Santhome Higher Secondary School, Maihar, is a Catholic institution established on 7th July 1982. Located 2 km from Maihar city on the Maihar–Satna Road, it offers a serene and eco-friendly environment for learning.
            </p>
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-2 gap-10">
                <!-- Origins Card -->
                <div class="bg-white p-8 shadow-sm border-t-4 border-yellow-600 hover:shadow-lg transition reveal-on-scroll">
                    <img 
                        src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/STHS-Logo1.png" 
                        class="h-16 mb-4 object-contain" alt="Logo"
                        onerror="this.style.display='none'"
                    >
                    <h3 class="text-2xl font-bold text-slate-900 mb-3">Origin & History</h3>
                    <p class="text-slate-600 text-sm mb-6 leading-relaxed">
                        The school is run in collaboration with the Sisters of the Daughters of St. Thomas, ensuring a foundation deeply rooted in discipline and moral values. Guided by Christian principles yet open to all.
                    </p>
                    <!-- Updated Button to trigger History Modal -->
                    <button onclick="openHistoryModal()" class="text-yellow-700 font-bold text-xs uppercase tracking-widest hover:text-slate-900 flex items-center gap-1 transition">
                        Read More <i class="fas fa-arrow-right ml-1"></i>
                    </button>
                </div>

                <!-- Mission Card -->
                <div class="bg-white p-8 shadow-sm border-t-4 border-slate-900 hover:shadow-lg transition reveal-on-scroll">
                    <i class="fas fa-bullseye text-4xl text-slate-800 mb-4"></i>
                    <h3 class="text-2xl font-bold text-slate-900 mb-3">Mission & Vision</h3>
                    <p class="text-slate-600 text-sm mb-6 leading-relaxed">
                        To create responsible citizens who are intellectually competent, morally strong, socially aware, and spiritually inspired. We nurture students from early years up to senior secondary level.
                    </p>
                    <a href="#about" class="text-slate-900 font-bold text-xs uppercase tracking-widest hover:text-yellow-700">Read More <i class="fas fa-arrow-right ml-1"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- LIFE AT SANTHOME (Touch Optimized) -->
    <section id="life" class="bg-slate-900">
        <div class="max-w-7xl mx-auto px-4 py-16 text-center reveal-on-scroll">
            <h2 class="text-4xl font-bold text-white mb-4">Life at Santhome</h2>
            <p class="text-slate-400 max-w-2xl mx-auto">Our holistic approach to education categorized into key pillars.</p>
        </div>
        
        <div class="life-grid">
            <!-- 1. Academics -->
            <div class="life-item" onclick="toggleLifeItem(this)">
                <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/Frontend/images/slider/1.jpg" alt="Academics" onerror="handleImageError(this, 'https://via.placeholder.com/400x600/111/fff?text=Academics')">
                <div class="life-overlay">
                    <h3 class="life-title">Academics</h3>
                    <div class="life-text">Nurturing intellectual curiosity through a comprehensive CBSE curriculum.</div>
                </div>
            </div>
            
            <!-- 2. Values -->
            <div class="life-item" onclick="toggleLifeItem(this)">
                <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/about.jpg" alt="Values" onerror="handleImageError(this, 'https://via.placeholder.com/400x600/111/fff?text=Values')">
                <div class="life-overlay">
                    <h3 class="life-title">Values</h3>
                    <div class="life-text">Deeply rooted in discipline, moral values, and holistic development.</div>
                </div>
            </div>
            
            <!-- 3. Leadership -->
            <div class="life-item" onclick="toggleLifeItem(this)">
                <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/Frontend/images/student-council.jpg" alt="Leadership" onerror="handleImageError(this, 'https://via.placeholder.com/400x600/111/fff?text=Leadership')">
                <div class="life-overlay">
                    <h3 class="life-title">Leadership</h3>
                    <div class="life-text">Preparing students for both academic achievements and real-life challenges.</div>
                </div>
            </div>
            
            <!-- 4. Sports -->
            <div class="life-item" onclick="toggleLifeItem(this)">
                <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/Frontend/images/infrastructure.jpg" alt="Sports" onerror="handleImageError(this, 'https://via.placeholder.com/400x600/111/fff?text=Sports')">
                <div class="life-overlay">
                    <h3 class="life-title">Sports</h3>
                    <div class="life-text">Building strength, character, and unity through physical education.</div>
                </div>
            </div>
            
            <!-- 5. Service -->
            <div class="life-item" onclick="toggleLifeItem(this)">
                <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/Frontend/images/library.jpg" alt="Service" onerror="handleImageError(this, 'https://via.placeholder.com/400x600/111/fff?text=Service')">
                <div class="life-overlay">
                    <h3 class="life-title">Service</h3>
                    <div class="life-text">Creating socially aware citizens committed to serving the community.</div>
                </div>
            </div>
        </div>
    </section>

    <!-- PRINCIPAL'S MESSAGE (Standalone Section) -->
    <section class="py-20 bg-slate-50 border-b border-slate-200">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="message-card flex flex-col md:flex-row gap-10 items-center reveal-on-scroll bg-white p-10 rounded shadow-md border-t-4 border-slate-900">
                <div class="w-full md:w-1/3 relative group">
                    <div class="absolute -inset-2 bg-yellow-100 rounded-full opacity-50 group-hover:opacity-100 transition duration-500"></div>
                    <img 
                        src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/uploads/leaders/49cd60cd-5329-4cc5-a9a1-6fc201f452ac.png" 
                        class="w-full object-contain relative z-10 drop-shadow-md rounded" 
                        alt="Principal" 
                        onerror="handleImageError(this, 'https://raw.githubusercontent.com/rudhm/santhomeschool/main/STHS-Logo1.png')"
                    >
                </div>
                <div class="w-full md:w-2/3 text-center md:text-left">
                    <h4 class="text-xs font-bold text-yellow-600 uppercase tracking-widest mb-2">Leadership</h4>
                    <h3 class="text-3xl font-serif text-slate-900 mb-4">Message from The Principal</h3>
                    <blockquote class="text-slate-600 text-lg italic mb-6 border-l-4 border-yellow-500 pl-4 bg-slate-50 py-2">
                        "Educating the mind without educating the heart is no education at all."
                    </blockquote>
                    <p class="text-slate-500 text-sm mb-6 leading-relaxed">
                        At Santhome, we strive to create an environment where every child discovers their potential. We are committed to the integral development of our students, fostering intellectual growth alongside moral and spiritual maturity.
                    </p>
                    <button onclick="openPrincipalModal()" class="btn-gold text-slate-900 border-slate-900 hover:bg-slate-900 hover:text-white">Read Full Message</button>
                </div>
            </div>
        </div>
    </section>

    <!-- FACILITIES SECTION (New Grid) -->
    <section class="py-24 bg-white" id="facilities">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

            <!-- Section Header -->
            <div class="text-center max-w-3xl mx-auto mb-16 reveal-on-scroll">
                <h4 class="text-yellow-600 font-bold text-sm uppercase tracking-widest mb-3">
                    Infrastructure
                </h4>
                <h2 class="text-4xl font-serif font-bold text-slate-900 mb-6">
                    Our Facilities
                </h2>
                <p class="text-slate-600 leading-relaxed text-lg font-light">
                    Santhome Higher Secondary School, Maihar provides smart classrooms, a well-stocked library, modern science and computer labs, and dedicated spaces for arts and music. Excellent sports facilities, safe transport, clean drinking water, and a secure CCTV-enabled campus ensure a balanced environment for learning, creativity, and overall growth.
                </p>
            </div>

            <!-- Facilities Grid -->
            <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-8">

                <!-- Facility Card: Computer -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-desktop text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">Computer Lab</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Advanced computer labs for digital learning and innovation.
                    </p>
                </div>

                <!-- Facility Card: Physics -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-atom text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">Physics Lab</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Well-equipped physics lab for experiments and innovation.
                    </p>
                </div>

                <!-- Facility Card: Chemistry -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-flask text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">Chemistry Lab</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Modern chemistry lab for scientific discovery.
                    </p>
                </div>

                <!-- Facility Card: Biology -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-dna text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">Biology Lab</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Hands-on biology learning with modern equipment.
                    </p>
                </div>

                <!-- Facility Card: Library -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-book-open text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">School Library</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Spacious library with rich academic resources.
                    </p>
                </div>

                <!-- Facility Card: Playground -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-futbol text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">Playground</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Spacious playground for sports and physical fitness.
                    </p>
                </div>

                <!-- Facility Card: Activities -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-paint-brush text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">Activities</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Student activities for creativity, leadership, and teamwork.
                    </p>
                </div>

                <!-- Facility Card: Water -->
                <div class="group border border-slate-200 p-6 text-center hover:border-yellow-600 transition reveal-on-scroll hover:shadow-lg">
                    <i class="fas fa-tint text-4xl text-slate-800 mb-4 group-hover:text-yellow-600 transition transform group-hover:scale-110"></i>
                    <h3 class="font-serif text-xl font-bold text-slate-900 mb-2">Mineral Water</h3>
                    <p class="text-sm text-slate-600 font-light">
                        Safe and clean mineral water for healthy drinking.
                    </p>
                </div>

            </div>

            <!-- CTA -->
            <div class="text-center mt-16 reveal-on-scroll">
                <button onclick="openFacilityModal()" class="btn-gold text-slate-900 border-slate-900 hover:bg-slate-900 hover:text-white">
                    View More Details
                </button>
            </div>

        </div>
    </section>

    <!-- NEWS & UPDATES -->
    <section class="py-24 bg-white" id="news">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12 reveal-on-scroll">
                <h2 class="text-3xl font-serif font-bold text-slate-900">News & Events</h2>
            </div>
            
            <div class="grid lg:grid-cols-12 gap-10">
                <!-- Left: Featured -->
                <div class="lg:col-span-5 bg-yellow-50 p-8 border border-yellow-100 flex flex-col justify-center items-center text-center reveal-on-scroll">
                    <span class="bg-slate-900 text-white text-[10px] font-bold uppercase px-2 py-1 mb-4">Spotlight</span>
                    <img 
                        src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/Toppers-badge.png" 
                        class="h-40 w-auto mb-6 drop-shadow-md hover:scale-105 transition" 
                        alt="Toppers"
                        onerror="handleImageError(this, '')"
                    >
                    <h3 class="text-2xl font-serif text-slate-900 mb-2">Hall of Fame</h3>
                    <p class="text-sm text-slate-600 mb-6">Celebrating the academic excellence of our CBSE Board Exam toppers.</p>
                    <button onclick="openTopperModal()" class="btn-gold text-slate-900 border-slate-900 hover:bg-slate-900">View Toppers List</button>
                </div>

                <!-- Right: List -->
                <div class="lg:col-span-7 reveal-on-scroll">
                    <div class="border border-slate-200 h-full flex flex-col">
                        <ul class="divide-y divide-slate-100">
                            <li class="p-6 hover:bg-slate-50 transition flex gap-4 items-start group">
                                <div class="bg-slate-100 p-2 text-center min-w-[70px] rounded group-hover:bg-yellow-500 group-hover:text-white transition">
                                    <span class="block text-xl font-bold">15</span>
                                    <span class="block text-xs uppercase font-bold">Oct</span>
                                </div>
                                <div>
                                    <h4 class="text-lg font-bold text-slate-800 hover:text-yellow-600 transition cursor-pointer mb-1">Book List 2025-26 Released</h4>
                                    <p class="text-sm text-slate-500 line-clamp-2">The complete list of prescribed textbooks for all classes is now available for download.</p>
                                </div>
                            </li>
                            <!-- More items... -->
                            <li class="p-6 hover:bg-slate-50 transition flex gap-4 items-start group">
                                <div class="bg-slate-100 p-2 text-center min-w-[70px] rounded group-hover:bg-yellow-500 group-hover:text-white transition">
                                    <span class="block text-xl font-bold">02</span>
                                    <span class="block text-xs uppercase font-bold">Sep</span>
                                </div>
                                <div>
                                    <h4 class="text-lg font-bold text-slate-800 hover:text-yellow-600 transition cursor-pointer mb-1">Admissions Open (Nursery-XI)</h4>
                                    <p class="text-sm text-slate-500 line-clamp-2">Applications are invited for the academic year 2025-26. Visit the school office for forms.</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-slate-900 text-slate-400 py-16 text-sm" id="contact">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-4 gap-12 border-b border-slate-800 pb-12 mb-8">
                <!-- Logo -->
                <div>
                    <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/STHS-Logo.png" alt="Logo" class="w-32 bg-white p-2 mb-6" onerror="handleImageError(this, 'footer-fallback')">
                    <div id="footer-fallback" class="hidden w-20 h-20 bg-slate-800 border border-yellow-600 flex items-center justify-center mb-6"><i class="fas fa-graduation-cap text-2xl text-yellow-500"></i></div>
                </div>
                <!-- Address -->
                <div>
                    <h4 class="text-white font-bold uppercase tracking-widest mb-6">Address</h4>
                    <ul class="space-y-4">
                        <li class="flex items-start"><i class="fas fa-map-marker-alt mt-1 mr-3 text-yellow-600"></i><span>Santhome Higher Secondary School,<br>Maihar, Satna (M.P.) - 485771</span></li>
                        <li class="flex items-center"><i class="fas fa-phone-alt mr-3 text-yellow-600"></i><span>07674 – 232453</span></li>
                        <li class="flex items-center"><i class="fas fa-envelope mr-3 text-yellow-600"></i><span class="break-all">santhomeschoolmaihar@gmail.com</span></li>
                    </ul>
                </div>
                <!-- Links -->
                <div>
                    <h4 class="text-white font-bold uppercase tracking-widest mb-6">Useful Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#about" class="hover:text-yellow-500 transition">About Us</a></li>
                        <li><a href="#academics" class="hover:text-yellow-500 transition">Academics</a></li>
                        <li><a href="#disclosure" class="hover:text-yellow-500 transition">Mandatory Disclosure</a></li>
                    </ul>
                </div>
                <!-- Social -->
                <div>
                    <h4 class="text-white font-bold uppercase tracking-widest mb-6">Connect</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 border border-slate-600 flex items-center justify-center hover:bg-yellow-600 hover:border-yellow-600 hover:text-white transition"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="w-10 h-10 border border-slate-600 flex items-center justify-center hover:bg-yellow-600 hover:border-yellow-600 hover:text-white transition"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="flex flex-col md:flex-row justify-between items-center text-xs uppercase tracking-widest text-slate-500">
                <p>&copy; <span id="year">2026</span> Santhome Higher Secondary School.</p>
                <p>Affiliation No: 1031039</p>
            </div>
        </div>
    </footer>

    <!-- TOPPER MODAL -->
    <div id="topper-modal" class="hidden fixed inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center p-4 backdrop-blur-sm">
        <button onclick="closeTopperModal()" class="absolute top-4 right-4 text-white text-4xl hover:text-yellow-500 transition focus:outline-none">&times;</button>
        <div class="max-w-4xl w-full bg-white rounded-lg overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
            <div class="bg-slate-900 p-4 flex justify-between items-center border-b border-slate-700">
                <h3 class="text-white font-serif text-xl"><i class="fas fa-trophy text-yellow-500 mr-2"></i> Hall of Fame</h3>
                <span class="text-slate-400 text-xs uppercase tracking-widest">Meritorious Students</span>
            </div>
            <div class="flex-1 overflow-y-auto p-6 bg-slate-100 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 auto-rows-min" id="topper-gallery-container">
                <!-- Injected via JS -->
            </div>
        </div>
    </div>

    <!-- PRINCIPAL MESSAGE MODAL (NEW) -->
    <div id="principal-modal" class="hidden fixed inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center p-4 backdrop-blur-sm">
        <button onclick="closePrincipalModal()" class="absolute top-4 right-4 text-white text-4xl hover:text-yellow-500 transition focus:outline-none">&times;</button>
        <div class="max-w-3xl w-full bg-white rounded-lg overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
            <div class="bg-slate-900 p-6 flex justify-between items-center border-b border-slate-700">
                <div>
                    <h3 class="text-white font-serif text-2xl">Principal's Message</h3>
                    <p class="text-yellow-500 text-xs uppercase tracking-widest mt-1">Leading with Vision</p>
                </div>
                <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/STHS-Logo.png" class="h-12 w-auto bg-white p-1 rounded opacity-80" alt="Logo">
            </div>
            
            <div class="flex-1 overflow-y-auto p-8 bg-slate-50 text-slate-700 leading-relaxed text-sm md:text-base space-y-4 font-light">
                <blockquote class="border-l-4 border-yellow-600 pl-4 italic text-slate-900 font-serif text-lg my-6 bg-yellow-50 py-2 pr-2 rounded-r">
                    “Educating the mind without educating the heart is no education at all” – Aristotle
                </blockquote>

                <p>Santhome offers preparatory programmes that provide a challenging academic environment emphasizing not only learning but also social and personal growth. At the heart of our philosophy lie values of trust, respect, innovation, and a sense of community. Building on these firm foundations, we continue to focus on enhancing the quality of school life for the benefit of our learners. Our buildings have been renovated, high-quality teachers appointed, and the curriculum is regularly reviewed to ensure that it remains relevant and future-focused, allowing both learners and teachers to fully exploit the best of modern learning opportunities.</p>

                <p>This institution envisages an all-round and balanced education based on sound intellectual, physical, moral, and social formation. Special emphasis is laid on character formation and personality development. Our aim is to nurture students to be erudite, patriotic, law-abiding, and ceaselessly striving for excellence, while also cultivating deep concern for all, especially for the weak and marginalized sections of society. Whatever you learn here will guide you throughout life, enabling you to stand firm in every situation and making your journey successful and fulfilling.</p>

                <p>At Santhome, the curriculum emphasizes knowledge, understanding, critical thinking, and problem-solving abilities. We believe every learner is unique and has the ability to succeed. As educators, it is our responsibility to nurture and develop each child, preparing them for life beyond school. Learners are continually encouraged to value diversity, care for others, and develop into responsible global citizens with respect for the environment.</p>

                <p>Our dedicated team strives for excellence by preparing students for lifelong learning. We encourage them to become self-directed, realistic, and responsible decision-makers in an ever-changing, multicultural world. Ultimately, each learner’s success depends on the effort they invest, and we are committed to guiding them at every step.</p>

                <p>We also recognize the importance of collaboration between teachers, parents, and administrators. To strengthen this bond, we organize “Know Your Child” parent-teacher meetings every second Saturday. Additionally, our school uses ‘Newgen’ ERP software for administration and effective parent-school communication. Parents are also given access to our interactive website to track academic progress and stay informed about our academic and co-curricular activities.</p>

                <p>As we move forward, I warmly invite all parents to stay engaged with the school, explore our initiatives, and support our mission of holistic education. Together, let us empower our children to embrace the future with confidence, curiosity, and compassion.</p>

                <p class="font-bold text-slate-900 mt-6">May God bless you abundantly.</p>

                <div class="mt-8 pt-6 border-t border-slate-200">
                    <p class="italic text-slate-600">With best wishes for your success and happiness,</p>
                    <p class="font-serif text-xl font-bold mt-2 text-slate-900">Fr. Biju Joseph</p>
                    <p class="text-xs uppercase tracking-widest text-slate-500 font-bold">Principal, Santhome Higher Secondary School</p>
                </div>
            </div>
        </div>
    </div>

    <!-- HISTORY MODAL (NEW) -->
    <div id="history-modal" class="hidden fixed inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center p-4 backdrop-blur-sm">
        <button onclick="closeHistoryModal()" class="absolute top-4 right-4 text-white text-4xl hover:text-yellow-500 transition focus:outline-none">&times;</button>
        <div class="max-w-3xl w-full bg-white rounded-lg overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
            <div class="bg-slate-900 p-6 flex justify-between items-center border-b border-slate-700">
                <div>
                    <h3 class="text-white font-serif text-2xl">History of Santhome</h3>
                    <p class="text-yellow-500 text-xs uppercase tracking-widest mt-1">Genesis of Santhome</p>
                </div>
                <img src="https://raw.githubusercontent.com/rudhm/santhomeschool/main/STHS-Logo1.png" class="h-12 w-auto bg-white p-1 rounded opacity-80" alt="Logo">
            </div>
            
            <div class="flex-1 overflow-y-auto p-8 bg-slate-50 text-slate-700 leading-relaxed text-sm md:text-base space-y-4 font-light">
                <p>Santhome Higher Secondary School, Maihar is a Catholic institution under the management of the Satna Diocesan Society. It was established on 7th July 1982. It is situated in Maihar, 2 kms away from the city on the Maihar Satna Road.</p>
                <p>The School is run in collaboration with the sisters of The Daughters Of St. Thomas.</p>
                <p>A school is an institution designed to provide learning spaces and learning environments for the teaching of students under the direction of teachers. Most countries have systems of formal education, which is commonly compulsory. In these systems, students progress through a series of schools.</p>
            </div>
        </div>
    </div>

    <!-- AI CHAT WIDGET (GEMINI POWERED) -->
    <div id="ai-widget-container" class="fixed bottom-6 right-6 z-50 flex flex-col items-end gap-4">
        
        <!-- Chat Window - Fix initial state classes -->
        <div id="ai-chat-window" class="hidden bg-white w-80 md:w-96 rounded-lg shadow-2xl overflow-hidden border border-slate-200 flex flex-col transition-all duration-300 transform origin-bottom-right scale-95 opacity-0">
            <!-- Header -->
            <div class="bg-slate-900 p-4 flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-slate-900">
                        <i class="fas fa-robot text-sm"></i>
                    </div>
                    <div>
                        <h4 class="text-white font-serif font-bold text-sm">Santhome Assistant ✨</h4>
                        <p class="text-slate-400 text-[10px] uppercase tracking-wider">Online</p>
                    </div>
                </div>
                <button onclick="toggleChat()" class="text-slate-400 hover:text-white transition"><i class="fas fa-times"></i></button>
            </div>
            
            <!-- Messages Area -->
            <div id="chat-messages" class="h-80 overflow-y-auto p-4 bg-slate-50 space-y-3">
                <div class="flex items-start gap-2">
                    <div class="w-6 h-6 bg-yellow-500 rounded-full flex-shrink-0 flex items-center justify-center text-[10px] text-slate-900"><i class="fas fa-robot"></i></div>
                    <div class="bg-white p-3 rounded-tr-lg rounded-br-lg rounded-bl-lg text-xs text-slate-600 shadow-sm border border-slate-100">
                        Hello! I am the Santhome AI Assistant. How can I help you today regarding admissions, facilities, or school policies?
                    </div>
                </div>
            </div>
            
            <!-- Input Area -->
            <div class="p-3 bg-white border-t border-slate-100">
                <div class="flex gap-2">
                    <input type="text" id="chat-input" placeholder="Ask about fees, admission..." class="flex-1 bg-slate-50 border border-slate-200 rounded px-3 py-2 text-xs focus:outline-none focus:border-yellow-500 text-slate-700" onkeypress="handleEnter(event)">
                    <button onclick="sendMessage()" class="bg-slate-900 text-white w-8 h-8 rounded flex items-center justify-center hover:bg-yellow-600 transition">
                        <i class="fas fa-paper-plane text-xs"></i>
                    </button>
                </div>
                <div class="text-[9px] text-center text-slate-400 mt-2">Powered by Gemini AI ✨</div>
            </div>
        </div>

        <!-- Floating Button -->
        <button onclick="toggleChat()" class="bg-slate-900 text-yellow-500 w-14 h-14 rounded-full shadow-lg flex items-center justify-center text-2xl hover:bg-yellow-500 hover:text-slate-900 transition-all duration-300 transform hover:scale-110 group relative">
            <i class="fas fa-comment-dots"></i>
            <span class="absolute -top-1 -right-1 flex h-3 w-3">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-3 w-3 bg-yellow-500"></span>
            </span>
        </button>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        // --- 1. Dynamic Hero Slider ---
        const sliderImages = [
            { 
                url: 'https://raw.githubusercontent.com/rudhm/santhomeschool/main/Slider/IMG-20241028-WA0018.jpg', 
                title: '40 Years of Excellence', 
                sub: 'Excelling with Legacy, Leading with Purpose' 
            },
            { 
                url: 'https://raw.githubusercontent.com/rudhm/santhomeschool/main/Slider/IMG-20241204-WA0149.jpg', 
                title: 'Holistic Development', 
                sub: 'Nurturing Minds, Building Character' 
            },
            { 
                // Properly Encoded URL for filenames with spaces and commas
                url: 'https://raw.githubusercontent.com/rudhm/santhomeschool/main/Slider/SANTHOME%20HR.%20SEC.%20SCHOOL,%20MAIHAR.jpg', 
                title: 'State-of-the-Art Campus', 
                sub: 'A serene environment for learning and growth' 
            }
        ];
        
        let currentSlide = 0;
        const sliderContainer = document.getElementById('hero-slider-container');
        const heroTitle = document.getElementById('hero-title');
        const heroSub = document.getElementById('hero-subtitle');

        function initSlider() {
            // Create slide elements
            sliderImages.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                slideDiv.className = `hero-slide ${index === 0 ? 'active' : ''}`;
                
                // Set CSS background immediately
                slideDiv.style.backgroundImage = `url('${slide.url}')`;
                
                // Add error checking for robust image loading
                const img = new Image();
                img.onerror = function() {
                    console.log('Slider image failed, trying master branch:', slide.url);
                    const masterUrl = slide.url.replace('/main/', '/master/');
                    slideDiv.style.backgroundImage = `url('${masterUrl}')`;
                };
                img.src = slide.url;

                sliderContainer.appendChild(slideDiv);
            });

            // Cycle if more than 1 image
            if (sliderImages.length > 1) {
                setInterval(() => {
                    const slides = document.querySelectorAll('.hero-slide');
                    slides[currentSlide].classList.remove('active');
                    currentSlide = (currentSlide + 1) % slides.length;
                    slides[currentSlide].classList.add('active');
                    
                    // Update Text - Fix flickering using classes
                    heroTitle.classList.add('opacity-0');
                    heroSub.classList.add('opacity-0');
                    setTimeout(() => {
                        heroTitle.textContent = sliderImages[currentSlide].title;
                        heroSub.textContent = sliderImages[currentSlide].sub;
                        heroTitle.classList.remove('opacity-0');
                        heroSub.classList.remove('opacity-0');
                    }, 700);
                }, 5000);
            }
        }

        // --- 2. Scroll Animation (Reveal & Count) ---
        const observerOptions = { threshold: 0.2 };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Reveal Fade
                    if (entry.target.classList.contains('reveal-on-scroll')) {
                        entry.target.classList.add('is-visible');
                    }
                    // Start Counters only when container is visible
                    if (entry.target.id === 'stats-container') {
                        runCounters(entry.target);
                    }
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.reveal-on-scroll').forEach(el => observer.observe(el));
        const statsSection = document.getElementById('stats-container');
        if(statsSection) {
            statsSection.classList.add('reveal-on-scroll');
            observer.observe(statsSection);
        }

        function runCounters(container) {
            const counters = container.querySelectorAll('.counter-num');
            counters.forEach(counter => {
                if (counter.dataset.done) return; // Prevent re-running

                const target = +counter.getAttribute('data-target');
                const speed = 200; // Lower is faster
                const inc = target / speed;
                
                const updateCount = () => {
                    const count = +counter.innerText;
                    if (count < target) {
                        counter.innerText = Math.ceil(count + inc);
                        setTimeout(updateCount, 20);
                    } else {
                        counter.textContent = `${target}+`; // Append +
                        counter.dataset.done = "true";
                    }
                };
                updateCount();
            });
        }

        // --- 3. Menu & Modal Logic ---
        function toggleMenu() {
            const menu = document.getElementById('menu-overlay');
            menu.classList.toggle('open');
            document.body.style.overflow = menu.classList.contains('open') ? 'hidden' : '';
        }

        // Mobile Life Item Accordion
        function toggleLifeItem(activeItem) {
            document.querySelectorAll('.life-item.mobile-active')
                .forEach(item => {
                    if (item !== activeItem) item.classList.remove('mobile-active');
                });
            activeItem.classList.toggle('mobile-active');
        }

        const topperData = [
            { file: '1767698654395.png', name: 'Topper 1', class: 'Class XII', score: 'Result Awaited' },
            { file: '1767698706109.png', name: 'Topper 2', class: 'Class X', score: 'Result Awaited' },
            { file: '1767698746946.png', name: 'Topper 3', class: 'Class XII', score: 'Result Awaited' }
        ];

        function openTopperModal() {
            const modal = document.getElementById('topper-modal');
            const container = document.getElementById('topper-gallery-container');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            container.innerHTML = '';
            
            const baseUrl = 'https://raw.githubusercontent.com/rudhm/santhomeschool/main/uploads/toppers/';

            if (topperData.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center p-10 text-slate-500">No topper lists available.</div>';
                return;
            }

            topperData.forEach(student => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded shadow hover:shadow-lg transition flex flex-col overflow-hidden';
                const img = document.createElement('img');
                img.src = baseUrl + student.file;
                img.alt = student.name;
                img.className = 'w-full h-64 object-cover bg-slate-200';
                img.onerror = function() { handleImageError(this, 'https://raw.githubusercontent.com/rudhm/santhomeschool/main/STHS-Logo1.png'); };
                
                const details = document.createElement('div');
                details.className = 'p-4 text-center border-t border-slate-100';
                details.innerHTML = `<h4 class="font-serif text-lg font-bold text-slate-900">${student.name}</h4><p class="text-xs text-slate-500 uppercase font-bold mb-2">${student.class}</p><span class="bg-yellow-100 text-yellow-800 text-xs font-bold px-2 py-1 rounded">${student.score}</span>`;
                
                card.appendChild(img);
                card.appendChild(details);
                container.appendChild(card);
            });
        }

        function closeTopperModal() {
            document.getElementById('topper-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // --- Principal Modal Logic ---
        function openPrincipalModal() {
            const modal = document.getElementById('principal-modal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closePrincipalModal() {
            document.getElementById('principal-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // --- History Modal Logic ---
        function openHistoryModal() {
            const modal = document.getElementById('history-modal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeHistoryModal() {
            document.getElementById('history-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Close on click outside (for all modals)
        document.addEventListener('click', function(e) {
            if (e.target.id === 'topper-modal') closeTopperModal();
            if (e.target.id === 'principal-modal') closePrincipalModal();
            if (e.target.id === 'history-modal') closeHistoryModal();
        });

        // Close on ESC key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeTopperModal();
                closePrincipalModal();
                closeHistoryModal();
            }
        });

        // --- 4. GEMINI AI CHAT LOGIC ---
        const apiKey = ""; // API Key provided by environment
        
        function toggleChat() {
            const chatWindow = document.getElementById('ai-chat-window');
            if (chatWindow.classList.contains('hidden')) {
                chatWindow.classList.remove('hidden');
                setTimeout(() => {
                    chatWindow.classList.remove('scale-95', 'opacity-0');
                    chatWindow.classList.add('scale-100', 'opacity-100');
                }, 10);
            } else {
                chatWindow.classList.remove('scale-100', 'opacity-100');
                chatWindow.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    chatWindow.classList.add('hidden');
                }, 300);
            }
        }

        function handleEnter(e) {
            if (e.key === 'Enter') sendMessage();
        }

        async function sendMessage() {
            const inputField = document.getElementById('chat-input');
            const message = inputField.value.trim();
            if (!message) return;

            // Secure Check
            if (!apiKey) {
                addMessage("Chat service is temporarily unavailable. Please contact the school office.", 'bot');
                return;
            }

            addMessage(message, 'user');
            inputField.value = '';

            const loadingId = addMessage('Thinking...', 'bot', true);

            const systemPrompt = `You are the helpful AI assistant for Santhome Higher Secondary School, Maihar...`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [
                            { role: "user", parts: [{ text: systemPrompt + "\n\nUser Question: " + message }] }
                        ]
                    })
                });

                const data = await response.json();
                const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || "I apologize, I couldn't process that.";
                
                document.getElementById(loadingId).remove();
                addMessage(aiResponse, 'bot');

            } catch (error) {
                console.error("AI Error:", error);
                document.getElementById(loadingId).remove();
                addMessage("Sorry, I'm having trouble connecting right now.", 'bot');
            }
        }

        function addMessage(text, sender, isLoading = false) {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            const id = 'msg-' + Date.now();
            div.id = id;
            div.className = `flex items-start gap-2 ${sender === 'user' ? 'flex-row-reverse' : ''}`;
            
            const icon = sender === 'bot' 
                ? '<div class="w-6 h-6 bg-yellow-500 rounded-full flex-shrink-0 flex items-center justify-center text-[10px] text-slate-900"><i class="fas fa-robot"></i></div>'
                : '<div class="w-6 h-6 bg-slate-200 rounded-full flex-shrink-0 flex items-center justify-center text-[10px] text-slate-600"><i class="fas fa-user"></i></div>';
            
            const bubbleStyle = sender === 'bot'
                ? 'bg-white text-slate-600 border border-slate-100 rounded-tr-lg rounded-br-lg rounded-bl-lg'
                : 'bg-slate-900 text-white rounded-tl-lg rounded-bl-lg rounded-br-lg';

            div.innerHTML = `
                ${icon}
                <div class="${bubbleStyle} p-3 text-xs shadow-sm max-w-[85%]">
                    ${isLoading ? '<i class="fas fa-spinner fa-spin"></i>' : text}
                </div>
            `;
            
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            return id;
        }

        // Init
        document.addEventListener("DOMContentLoaded", function() {
            // Hide Preloader
            const preloader = document.getElementById("preloader");
            if(preloader) {
                preloader.style.opacity = "0";
                setTimeout(() => { preloader.style.display = "none"; }, 500);
            }
            
            initSlider();
            document.getElementById('year').innerText = new Date().getFullYear();
        });

        // Header Scroll Effect
        window.addEventListener('scroll', () => {
            const header = document.getElementById('main-header');
            if (window.scrollY > 50) header.classList.add('py-0');
            else header.classList.remove('py-0');
        });
    </script>
</body>
</html>
